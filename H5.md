# Schneier 2015: Applied Cryptography

## 2.3 One-way functions

- Important in public-key cryptography
- Easy to compute in one direction but hard to reverse
- "Hard", it would take an incredibly long time to reverse even with all the world's computers
- No solid proof that one-way functions exist, but some problems seem like one-way functions

- Can't be used alone for encryption because they can't be reversed
- Not suitable for sending secret messages on their own
- Some cryptographic applications exist

- Trapdoor is a special type of one-way function
- Trapdoor is easy to compute in one direction and hard to compute in the other
- Has a secret "trapdoor" that, if known, makes it easy to compute in the hard direction

## 2.4 One-way hash functions

- One-Way hash functions are called by various names like message digest, fingerprint, etc.
- Crucial in modern cryptography and used in many protocols
- Take a variable-length input and turn it into a fixed-length output
- Used to "fingerprint" data, indicating if it's likely the same as the original
- Easy to compute the hash from data, but hard to reverse it to find the original data
- A good hash function makes it difficult to find two different inputs with the same hash
- The hash process is public, and its security lies in being one-way and resistant to changes

Use in Verifying Files :

- Think of it as a way to fingerprint files for verification
- If you have a file and want to check if someone else has the same file without sharing it, you can share the hash value
- If they provide the correct hash, it's highly likely they have the same file
- Useful for financial transactions and data integrity checks

Message Authentication Codes (MACs):
- An extension of one-way hash functions with a secret key
- The hash value depends on both the data and the key
- Provides the same security principles as hash functions but requires the key to verify
- Can be built from hash functions or encryption algorithms
- Ensures that only those with the key can verify the hash value

__________________





# Särökaari 2018

- Phishing: The practice of sending an email that appears to be coming from a legitimate source, with the main goal of gaining influence over the target to retrieve sensitive personal identifiable information and passwords in order to gain access to the internal network
- It can contain links to malicious sites
- Malicious attachments that execute code
- Tested in a university in Germany: 34% of the students clicked on the link out of curiosity
- 20% believed they knew the sender because the name used was very common (Bower)
- Social engineering and phishing involve interacting with real people
- In Finland, the data you provide is typically anonymized to protect individuals
- When conducting phishing, it's important to check that SPF records are properly configured. If not, you can send phishing emails that are difficult to detect
- DKIM stands for "DomainKeys Identified Mail" (an email authentication validation mechanism)
- DDE (Dynamic Data Exchange) allows you to use Word documents to send data between applications (from Word to PowerShell to attempt code execution)
- Palo Alto offers a feature on their website where you can request to change a site from a blacklist to a more legitimate one, effectively whitelisting it in their database
- Site cloning, should always use HTTPS
- Domain names with foreign characters (other alphabets) can be used in phishing attacks
- Phishing methods that work well include :
  - Fake package delivery messages
  - Impersonating the IT service desk
  - Targeting LinkedIn users
  - Exploiting events like Christmas parties and summer parties
- The inevitability of a click : It takes a certain number of emails to get someone to click a phishing link
  - Sending three emails results in a 50% "success" rate (someone clicking)
  - Sending six emails yields over an 80% "success" rate
  - Sending ten or more emails almost guarantees that someone will open the email
- Just clicking a link isn't enough; additional steps like downloading or providing credentials are often required
  - Phishing emails may prompt you to change your passwords (beware)
- Reconnaissance is crucial in phishing; attackers gather information to appear legitimate and gain trust
- What you can do :
  - Implement SPF, DKIM, and DMARC email authentication measures
  - Keep your domains secure
  - Educate and train users to recognize and report phishing attempts
  - Strengthen your infrastructure
- Only 10% to 15% of people reported phishing incidents
- Phishing must be highly targeted based on what piques an individual's curiosity
- Statistics show that someone will almost always click the link in a phishing email

________________





# Install Hashcat

```
1. Install the apps
```

![image-20230921190634683](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921190634683.png)

![image-20230921203001477](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921203001477.png)

```
2. Create a new directory
```

![image-20230921190739923](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921190739923.png)

```
3. Get a big dictionary
```

![image-20230921191104598](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921191104598.png)

![image-20230921191148919](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921191148919.png)

![image-20230921191209114](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921191209114.png)

```
4. Take a look to the dicrionary
```

![image-20230921191243788](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921191243788.png)

```
5. How many words are in there ?
```

![image-20230921191322736](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921191322736.png)

Over 14 million words

```
6. Compare hashes with "hashcat --example-hashes" in an easy way. 
```

![image-20230921192428006](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921192428006.png)

Normally, the correct hash type is among the first three candidates. So, let's try with MD5 since it's the most well-known.

```
7. Let's crack the hash (6b1628b016dff46e6fa35684be6acc96)
```

![image-20230921193032595](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921193032595.png)

```
8. Here the hash cracked
```

![image-20230921193139115](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921193139115.png)

________________





# Crack this hash: 8eb8e307a6d649bc7fb51443a06a216f

```
1. Since we've already installed the apps, we can begin comparing hashes
```

![image-20230921193511268](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921193511268.png)

```
2. Let's crack the hash using MD5 - Here, I assume that this hash originates from the rockyou dictionary
```

![image-20230921194002646](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921194002646.png)

```
3. Here is the answer (february)
```

![image-20230921194039388](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921194039388.png)

_________________





# Gone phishing

**Create a phishing email. In addition to the email, you must explain your tactics and the scenario where the phishing email is used.** 

```
To create my phishing email, I will target Zalando Lounge users. The goal is to make them click on a link that takes them to a fake Zalando login page, where they will be asked to enter their username and password.

In this email, which will be personalized (with the person's name), Zalando offers its most loyal customers a free trial of Zalando Prime. This includes free shipping and early access to offers two days before other users. Considering that Zalando Lounge is based on short-term offers with limited stock, users will be tempted to click on the link, firstly to have exclusive access to the offer and a well-stocked inventory, and secondly to benefit from free shipping.

The email will be sent from the address info@servce-mail.zalando-lounge.fi, which differs very slightly from the official Zalando address. Of course, we now know it's a phishing email, so we carefully read the address character by character. However, I believe that an average user would not notice the difference.
```

![image-20230921202427665](C:\Users\eleon\AppData\Roaming\Typora\typora-user-images\image-20230921202427665.png)

# Sources

*CHAPTER 2: Protocol Building Blocks - Applied Cryptography: Protocols, Algorithms and Source Code in C, 20th Anniversary Edition [Book]*. https://www.oreilly.com/library/view/applied-cryptography-protocols/9781119096726/10_chap02.html

*Disobey 2018 - Phishing through email - Niklas Särökaari*. *www.youtube.com*, https://www.youtube.com/watch?v=m9YFJGSHYtYE

*ChatGPT - OpenAI* [ChatGPT (openai.com)](https://chat.openai.com/?model=text-davinci-002-render-sha)

*Zalando-lounge* [Lounge by Zalando - Online outlet for fashion & home (zalando-lounge.co.uk)](https://www.zalando-lounge.co.uk/#/)