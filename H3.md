# Braiterman et al 2020

### What is threat modeling?

- Threat modeling involves examining system representations to identify security and privacy concerns

### Why threat model?

- Recognize what can go wrong in a system
- Output of threat model (threats),  informs decisions that you might make

### Who should threat model?

- Everyone

### How should I use the Threat Modeling Manifesto?

- To develop a methodology that best fits your needs
- Threat Modeling Manifesto follows a similar format to that of the Agile Manifesto, it identifies two guidelines (values and principles)
- Values : something that has relative worth, merit, or importance
- Principles : fundamental truths of threat modeling

### Values

- Finding and fixing design issues
- Collaboration
- Understanding
- Threat modeling
- Continuous refinement

### Principles

- Improve the security and privacy of a system  through analysis
- Align threat modeling with development practices and adapt to design changes through manageable system iterations
- Outcomes are meaningful when they are of value to stakeholders
- Dialog is the key

**Patterns benefit threat modeling**

- Systematic approach
- Informed creativity
- Varied viewpoints
- Useful toolkit
- Theory into practice

**Anti-patterns inhibit threat modeling**

- Hero threat modeler
- Admiration for the problem
- Tendency of over focus
- Perfect representation

_________

# Shostack 2022

- Collaboration
- Sketching 

### 1. Welcome to the worlds shortest threat modeling course

- Introduction of shostack and the course

### 2. Why threat model ?

- Anticipate the problems
- You have to do this before anything (code, components, ...)
-  Set of methods that allows to think about security so the thing that we build is as secure as we need

### 3. The four question framework for threat modeling

- What we are working on ? What can go wrong ? What we can do better ? Did we do a good job ?
- Do structure to answer those questions, this is the good point to start

### 4. Collaborating to answer: What are we working on

- Collaboration ! 
- Use different tools
- (People) Opportunity to be drawing with the tools at the same time 

### 5. Sketching in threat modeling

- Starting to put what is in our heads into a form that other people can respond to
- We can use it to answer the question "what can go wrong ?"
- The first idea is maybe imperfect but we can discuss about it with other people 

### 6. Record your threat modeling work

- Do a document of record in drawing tool.
- Doing that we can learn new things about the system and add details

### 7. Data flow diagrams in threat modeling

- Threats tend to follow data 
- Five elements make up a data flow diagram
  - External entities (out of our control)
  - Processes (under our control)
  - Data flows (to connect external entities and processes)
  - Where data are stored (drums)
  - Trust boundary (different elements are operated by different entities/people/processes)

### 8. What can go wrong ?

- Give people space to express the things that they are concerned about and what goes wrong is that they are not sure what sort of answer we are looking for
- Help them with guidance such as STRIDE or kill chain

### 9. Introducing STRIDE for threat modeling

- Add structure to answer the question "what can go wrong"
- One of the most important structure is mnemonic STRIDE
  - Spoofing
  - Tampering
  - Repudiation
  - Information disclosure
  - Denial of service
  - Elevation of privilege
- Tool to improve our threat modeling and get better answers by thinking of each of these possible problems
- Ensure to have at least one threat for each STRIDE

### 10. What are we going to do about it

- Track our work
- Set of threat that we have discovered answering the question "what can go wrong" need to have something done about them
- Make sure you do something about this answers

### 11. What to do about it ? Risk management 

- Risk management is applied to a subset of threats we discover in threat modeling
- Threat modeling precede risk management, it informs risk management. Here how the two come together

### 12. Did we do a good job in threat modeling ?

- We have to ask ourself the question "would I recommend threat modeling to a colleague ? 

__________

# Shostack 2014

### Chapter 1 - Dive In and Threat Model !

- Threat modeling is about using models to find security problems
- Anticipate the threats that could affect you
- To understand threat model you have to practice and practice

### What Are You Building?

- Diagrams are useful for communicating information about software systems.
- You can start with a whiteboard diagram to depict data flow in the system.
- Questions about security and control should be considered early in the diagramming process.
- Defining "who controls what" can lead to a better understanding of the system.
- Trust boundaries should be added to the diagram to show areas of control.
  - Accounts
  - Virtual machines
  - Organizational boundaries

- Attack surface and trust boundaries are closely related concepts.
- Numbering processes, data flows, and data stores in the diagram can help maintain clarity.
- The physical form of the diagram can vary, but it should be kept with other development assets.
- The right diagram is assumed for now, and the focus shifts to identifying threats.

### What Can Go Wrong?

- After the diagram, you can begin identifying security issues.

#### *How To Play Elevation of Privilege*

- "Elevation of Privilege" is a game designed to assist with threat modeling.
- Identified threats should be documented and addressed.
- Threat modeling is a skill anyone in software development can learn.
- Threat identification can be made enjoyable and is not intimidating.

#### *Using the STRIDE Mnemonic to Find Threats*

- STRIDE is a mnemonic for identifying security issues:
  - Spoofing : Pretending to be someone else.
  - Tampering : Unauthorized modification of data.
  - Repudiation : Denying actions, whether true or false.
  - Denial of Service : Disrupting system availability.
  - Information Disclosure : Unauthorized exposure of data.
  - Elevation of Privilege : Unauthorized access to perform actions.
- Simplicity is key when starting; don't attempt complex tasks without foundational knowledge.

#### *Tips for Identifying Threats*

- Tips for identifying threats using Elevation of Privilege or STRIDE:
  - Start with external entities or events that drive activity.
  - Organize your approach, possibly using STRIDE order.
  - Don't disregard threats just because they don't match your current focus.
  - Write down all threats, even if they don't fit neatly into categories.
  - Prioritize feasible threats over highly unlikely scenarios.
  - Focus on threats that can be addressed effectively with available measures.
- Stay organized but avoid excessive structure that stifles creativity.
- Redundancy in identifying threats is beneficial to avoid missing important issues.
- Categories are not rigid; focus on identifying threats rather than categorizing them.
- Consider the practicality and likelihood of each threat when prioritizing them.

### Addressing Each Threat

- After identifying threats, the next step is to address them using one of four actions: mitigate, eliminate, transfer, or accept.
- Mitigating threats involves making it harder to exploit them, such as requiring passwords with complexity rules.
- Eliminating threats often means removing or redesigning features that pose a threat, like changing URLs to reduce predictability.
- Transferring threats means delegating risk management to another entity, like using the operating system for authentication.
- Accepting the risk involves acknowledging that a threat exists but choosing not to take further action due to cost or impracticality.

#### *Addressing Spoofing*

- To prevent spoofing of individuals, ensure each person has a unique username and authentication method.
- When accessing files on disk, specify the full file path (e.g., open(/path/to/file)) rather than open(file) to avoid security issues.
- Check security elements of the file descriptor after opening to prevent race conditions, especially for executables.
- Ensure that executable file permissions cannot be changed by attackers.

#### *Addressing Tampering*

- Tampering with a file can be easy for attackers with local accounts or by manipulating network data from a server.
- Concerns regarding tampering with memory involve threats from processes with fewer privileges or untrusted processes altering memory.
- For shared memory segments, ensure access control lists (ACLs) restrict access appropriately.
- In web applications, validate incoming data from sources like AJAX to verify its integrity.
- Preventing tampering with network data requires addressing spoofing and tampering to thwart man-in-the-middle attacks.
- Common solutions for network data tampering include SSL and emerging options like IP Security (IPsec) for confidentiality and tampering protection.

#### *Addressing Repudiation*

- Addressing repudiation involves ensuring that your system is designed to log events and that these logs are preserved and protected.
- Use reliable transport for logs, such as syslog over TCP/SSL
- Maintaining logs is essential for resolving disputes or investigations when individuals attempt to deny their actions.
- Logs can be targeted by attackers who may attempt to fill them up, force log rollovers, or overwhelm them with alarms to obscure real attacks.
- Securely process logs by clearly communicating their limitations, such as allowing plaintext or potential data injection.

#### *Addressing Information Disclosure*

- Network monitoring leverages network architecture to observe traffic, particularly in broadcast networks.
- Techniques can be used to divert traffic to or through monitoring stations in networks with different architectures.
- Addressing spoofing is crucial to prevent attackers from sitting in the middle and spoofing both ends of a network.
- Mitigating network information disclosure threats requires dealing with both spoofing and tampering; SSL and IP Security are effective options.
- To protect sensitive directory or filename information, create a parent directory with an innocuous name
- When file content needs protection, use cryptography, especially if the machine may fall into unauthorized hands.
- Choose carefully what information to disclose when designing an API or passing data across a trust boundary to avoid exposing sensitive data.

#### *Addressing Denial of Service*

- Network flooding threats can occur when static connection structures fill up or when accepting data from a possibly spoofed address results in returning a lot of data.
- Elastic resourcing, available from cloud providers, can help address limitations in resource management.
- Operating systems have limits or quotas to control resource consumption of user-level code; consider resources managed by the OS, such as memory and disk usage.
- Program-managed resources should be evaluated to prevent attackers from forcing more work than they are doing.
- Consider the concept of "proof of work" and its limitations in countering denial of service, as discussed in the paper by Ben Laurie and Richard Clayton titled "Proof of work proves not to work."

#### *Addressing Elevation of Privilege*

- Data/code confusion problems involve treating data as code and can result in issues like XSS attacks exploiting HTML's interweaving of code and data.
- Strategies for dealing with data/code confusion include using frameworks to separate code and data, looking at data before passing it to identify necessary validation, and considering the context between data generation and its use.
- Modern operating systems offer memory protection and randomization features to mitigate memory corruption attacks, often with minimal effort.
- Sandboxes are OS features designed to protect the OS or other programs from a corrupted program.
- Command injection attacks involve attackers supplying control characters followed by commands, such as SQL injection or shell script issues.

#### *Validate, Don't Sanitize*

- Validate input by knowing what you expect to receive and in what quantity.
- If the received data doesn't match expectations, discard it and return an error message.
- Errors in input sanitization can be costly, as you will rely on this function to ensure data integrity.
- Some attacks manipulate sanitization functions to execute malicious code.

#### *Trust the Operating System*

- The operating system provides essential security features, allowing you to focus on your unique value proposition.
- The operating system typically has higher privileges than your program or potential attackers.
- If an attacker gains control of the operating system, it can compromise your system regardless of your code's efforts.
- While trusting the operating system is important, many security building blocks are discretionary
- Ensure proper configuration and coding to complement the security features provided by the operating system.
- New technologies and systems may require you to build additional security mechanisms that the operating system may not yet offer.

#### *File Bugs*

- Treat each identified threat as a bug in your software.
- Implement a bug-tracking process to manage these threats consistently.
- Write bug reports for each threat
- Prioritize the bugs based on their potential impact, with elevation-of-privilege threats usually taking the highest priority.

### Checking your work

- Validation of the threat model is the final step in threat modeling.
- Tasks include checking the model, ensuring all threats have been considered, and validating the tests.

#### *Checking the model*

- Ensure that the final model accurately matches what was built.
- Arrange a meeting to review the diagram and answer key questions about its completeness and accuracy.
- Determine if the diagram covers all security decisions and can be used as-is for the next version.
- If everyone agrees, the diagram is considered up to date; otherwise, updates are necessary.

#### *Updating the Diagram*

- Update the diagram to include any missing key data or details.
- Focus on data flow rather than control flow.
- Consider adding more detail for cases where actions are qualified with "sometimes" or "also."
- Include details that explain security-relevant behavior.
- Incorporate agreed-upon facts from design or construction discussions to ensure everyone is on the same page.
- Clearly show who uses the data and the processes involved in moving it.
- Avoid overwhelming the diagram with excessive detail, making it hard to read.

#### *Diagram Details*

- Use sub-diagrams to show detailed information in specific areas, breaking down complex processes or components.
- Look for logical breakpoints in your system, such as hyper-complex processes, dispatchers, queuing systems, databases, or fail-over systems, where sub-diagrams can provide more detail.
- Keep in mind that the primary purpose of diagrams is to aid in understanding and discussing the system.

#### *Checking Each Threat*

- Validation activities involve two main aspects : 
  - Checking that you addressed each threat appropriately 
  - Verifying that you found all the necessary threats.

- Ensure that you have taken action on each unique threat identified during the threat modeling process, avoiding any oversight.
- Review and validate the actions taken for each threat, ensuring they are the correct measures to address the specific threat.
- Use bug tracking to document each threat and the actions taken, making it easier to perform subsequent validation.
- Consider using checklists for security bugs to systematically review and validate the actions for each threat.

#### *Checking Your Tests*

- Develop tests for each threat you've addressed to detect potential problems or vulnerabilities.
- Tests can be manual or automated, depending on the nature of the threat and the testing process.
- Consider the complexity of the threat and the risk it poses when determining the type of test to implement.
- Ensure that your security tests are aligned with other software tests and address the specific risks associated with each threat.
- Testing methodologies may vary based on the type of security concern, such as SQL injection or secure parsing of user input.

___________

# OWASP CheatSheets Series Team 2021

### Introduction

- How to create threat models for both existing and new systems
- Steps :
  - Document how data flows through a system
  - Document as many potential threats 
  - Document security controls that may be put in place to reduce the likelihood or impact of a potential threat

### Threat Modeling Terminology

- Threat agent : individual or group that is capable of carrying out a particular threat
- Impact :  potential damage caused by a particular threat
- Likelihood : possibility of a threat being carried out
- Controls : protective measures implemented to prevent, detect, mitigate, or reduce potential threats to your information, systems, or assets
- Preventions : controls that may prevent an attack being possible
- Mitigations : controls to reduce the likelihood or the impact of a threat (while not necessarily completely preventing it)
- Data flow diagram : how information flows through the system
- Trust boundary : location on the data flow diagram where data changes its level of trust

### Getting Started

#### Define Business Objectives

- Identify business objectives
- Identify security and compliance requirements
- These two things would help to evaluate the impact of any threat

#### Identify application design

- Draw a data flow diagram, the key to performing the threat modeling
- Update the documentation or create it if it doesn't exist

#### Create design documents

- 4+1 view model, one of the matured approaches to building design documents ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/400882cf-722d-4039-8739-b9f9d2a40a86)


#### Decompose and Model the System

- Understand how the system works and interacts with its ecosystem
- Start with creating a high-level flow diagram

#### Define and Evaluate your Assets

- Assets involved in the information flow should be defined and evaluated 

**Consider Data in transit and Data at rest**

- Protection of data while traveling from network to network or being transferred from a local storage device to a cloud storage device
- The risk profile for data in transit or data at rest depends on the security measures that are in place to secure data in either state

#### Create an information flow diagram

**Whiteboard Your Architecture**

Whiteboard system architecture by showing the major constraints and decisions in order to frame and start conversations. 

**Manage to present your DFD in the context of MVC**

- Model, View, Controller (MVC)

**Use tools to draw your diagram**

Tools 

- Owasp threat dragon
- Poirot
- Ms TMT
- Owasp pytm

#### Define Data Flow over your DFD

- DFD :  Data Flow Diagram

#### Define Trust Boundaries

- Define any distinct boundaries

#### Define applications user roles and trust levels

- Define access rights that the application will grant to external and internal entities

#### Highlight Authorization per user role over the DFD

- Highlight Authorization per user role

#### Define Application Entry points

- Define the interfaces through which potential attackers can interact with the application 

## Identify Threat Agents

### Define all possible threats

- Use Means, Motive, and Opportunities to understand Threats posed by Attackers, associate threat agent with system component that can interact with

### Map Threat agents to application Entry points

- Map threat agents to the application entry point

### Draw attack vectors and attacks tree

- Draw attack vectors and attacks tree.Identify Use Cases/Abuse Cases
- Re-Define attack vectors to consider multi-step attacks

### Mapping Abuse Cases to Use Cases

- Help identifying application logical threats

### Re-Define attack vectors

- After defining the attack vectors, the compromised user role could lead to further attacks into the application

## Write your Threat traceability matrix

### Define the Impact and Probability for each threat

- Enumerate Attacks posed by the most dangerous attacker in designated areas of the logical and physical maps of the target of evaluation
- Assume the attacker has a zero-day
- Use risk management methodology to determine the risk behind the threat
- Create risks in risk log for every identified threat or attack to any assets

**DREAD**

Evaluating each existing vulnerability using a mathematical formula to retrieve the vulnerability’s corresponding risk

- **D**amage - how bad would an attack be?
- **R**eproducibility - how easy it is to reproduce the attack?
- **E**xploitability - how much work is it to launch the attack?
- **A**ffected users - how many people will be impacted?
- **D**iscoverability - how easy it is to discover the threat?

*Risk Value = (Damage + Affected users) x (Reproducibility + Exploitability + Discoverability)*

**PASTA**

Attack Simulation & Threat Analysis 

- Methodology to perform application threat modeling
- Complete risk analysis to evaluate the risk for each of the identified threat
- Audience that knows impact knows the consequences on a product

*R = (T*V*P*I) / Countermeasures                                                 ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/1cb2aa0b-929a-4471-bf91-18902c8d2a3d)


### Rank Risks

Rank risks from most severe to least severe based on Means, Motive & Opportunity

- Risk Value: 01 to 12 → Risk Level: **Notice**
- Risk Value: 13 to 18 → Risk Level: **Low**
- Risk Value: 19 to 36 → Risk Level: **Medium**
- Risk Value: 37 to 54 → Risk Level: **High**

## Determine countermeasures and mitigation

- Identify risk owners and agree on risk mitigation with risk owners and stakeholders

### Identify risk owners

- Personnel that is responsible for mitigating the risk

### Agree on risk mitigation with risk owners and stakeholders

- Review the mitigation controls for each of the identified risks
- You should propose other mitigation controls

### Build your risk treatment strategy

- **Reduce** : building controls or a specific configuration
- **Transfer** : risk can be transferred to an outsourced third party
- **Avoid** : e.i. disabling a specific function in the application that is the source for that risk
- **Accept** : if acceptable criteria then designer risk owner can accept that risk

### Select appropriate controls to mitigate the risk

Select one of the controls to reduce the risk : 

- Upgrading the code
- Building a specific configuration

### Test risk treatment to verify remediation

- Mitigation controls would just reduce the risk
- Measure the value of the risk after applying the mitigation controls

### Reduce risk in risk log for verified treated risk

- Update the risk log to verify that risk has been reduced

### Periodically retest risk

- Application may require re-evaluating the expected threats
- Periodic retest for the identified risks and the implemented risk treatments

____

# Security hygiene

**What basic security practices should everyone follow? Are there some security hygiene practicies that you consider useful, but might be above an average Joe?** 

Basic security practices :
- Use strong and unique passwords
- Use a password manager

- Two-Factor Authentication (2FA)
- Keep Software Updated

- Beware of fishing and social engineering 
- Physically secure devices
- Secure your network (WiFi)
- Do regular backups

Useful security hygiene practices (above average Joe) :

- Employ a VPN
- Secure cloud storage (encrypt your data)
- Review and adjust privacy settings on all your social media and online services
- As developer you can follow secure coding practices

______

# Make-belief boogie-man - a threat model for imaginary company

### **What are we working on ?**

"**Poor People on the Road**" is a travel agency dedicated to providing affordable travel experiences for budget-conscious travelers. Our primary focus is on providing budget-friendly travel itineraries, booking accommodations, arranging transportation, and facilitating unique local experiences for our customers. 

##### *Assets :*

1. **Customer data** : including personal details, travel preferences, and booking history, is a fundament of our business. This data helps us personalize travel experiences and ensure customer satisfaction.

2. **Financial information** : including payment data and transaction histories, are crucial assets that require rigid protection to maintain trust and financial integrity.

3. **Travel itineraries** : the unique travel plans and itineraries we create for our customers represent our intellectual property and competitive advantage.

4. **Booking systems** : our booking and reservation systems are the mainstay of our operations, managing customer reservations, payment processing, and trip logistics.

5. **Online presence** : our website and online platform serve as the primary interface for customers to explore travel options and make bookings.

##### *Prioritization of key assets :*

   - **Customer data** is our crown jewel, as it fuels personalized experiences and must be protected to maintain trust.
   - **Financial information** is crucial to safeguard against fraud and maintain financial integrity.
   - **Travel itineraries** represent our unique selling proposition and must be protected to preserve our competitive edge.
   - **Booking systems** are vital for day-to-day operations and customer service.
   - **Online presence** is essential for attracting and serving customers.

##### *Security supports business :*

Security plays a crucial role in our business's success:

- Protecting customer data maintains trust, ensuring repeat business and positive referrals.
- Safeguarding financial information prevents fraud, preserving our financial stability.
- Protecting travel itineraries secures our competitive advantage, helping us stand out in the market.
- Ensuring the availability and integrity of booking systems keeps operations running smoothly.
- A secure online presence is essential for attracting and retaining customers.

##### *Diagram of Company Systems :*

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/faab140b-bf31-426f-8ec1-9f617959f63f)


```
External :
Customer can explore travel options, views itineraries and make bookings in our web servers
```

```
Internal : 
Here we can find the employees (so the company), our intranet and the reservation databse.
The reservation databse stores customer reservations, including travel dates, destinations and preferences
```

```
Internal backend :
The customer data stores personal customer information, such as names, addresses, and contact details
The financial records hold transaction history, invoices, and payment records
```

This diagram illustrates the interconnected systems within "Poor People on the Road" and the flow of data. Each component represents a critical part of the business, and the security of these systems is essential to safeguard customer data, financial integrity, and the unique travel itineraries that set the company apart in the market.

### What can go wrong ?

To assess potential risks and vulnerabilities I'll use the STRIDE model to identify and prioritize risks. 

##### **STRIDE :**

STRIDE, acronym for six threat categories: Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, and Elevation of Privilege.

1. **Spoofing** : 
   - **Risk** : Unauthorized individuals or entities impersonate legitimate users or systems
   - **Example** : An attacker spoofing a customer's identity to access their travel itineraries or payment information
2. **Tampering** :
   - **Risk** : Unauthorized modification or alteration of data or systems
   - **Example** : An attacker tampering with booking information to change travel details or prices
3. **Repudiation** :
   - **Risk** : Denial of actions or events that have occurred, leading to disputes or lack of accountability
   - **Example** : A customer denying making a booking or a payment
4. **Information Disclosure** :
   - **Risk** : Unauthorized access or exposure of sensitive information
   - **Example** : Customer data or travel itineraries being accessed by an unauthorized user due to weak access controls
5. **Denial of Service (DoS)** :
   - **Risk** : Disruption of booking and reservation systems, making them unavailable to customers
   - **Example** : A DoS attack overwhelming the booking platform, causing it to crash or slow down significantly
6. **Elevation of Privilege** :
   - **Risk** : Unauthorized escalation of privileges, allowing attackers to access sensitive resources
   - **Example** : An attacker exploiting a vulnerability to gain admin-level access to the booking system



##### **Prioritizing Risks :**

1. **Information Disclosure** :
   - Risk : Unauthorized access or exposure of customer data
   - Mitigation : Implement strong access controls and encryption
   - Priority : High
     - Probability : 0.4 (Moderate)
     - Monetary Value : 0.8 (High)
     - Expected Value (EV) : 0.4 * 0.8 = 0.32 (High)
   
2. **Denial of Service (DoS) **:
   - Risk : Disruption of booking and reservation systems
   - Mitigation : Implement DDoS protection and redundancy
   - Priority : Moderate
     - Probability : 0.5 (Moderate)
     - Monetary Value : 0.6 (Moderate)
     - Expected Value (EV) : 0.5 * 0.6 = 0.3 (Moderate)
   
3. **Spoofing** :
   - Risk : Unauthorized access using impersonated identities
   - Mitigation : Implement strong authentication mechanisms
   - Priority : Moderate
     - Probability : 0.4 (Moderate)
     - Monetary Value : 0.5 (Moderate)
     - Expected Value (EV) : 0.4 * 0.5 = 0.2 (Moderate)
   
4. **Tampering** :
   - Risk : Unauthorized modification of data or systems
   - Mitigation : Use data encryption and integrity checks
   - Priority : Low to Moderate
     - Probability : 0.3 (Low to Moderate)
     - Monetary Value : 0.5 (Moderate)
     - Expected Value (EV) : 0.3 * 0.5 = 0.15 (Low to Moderate)
   
5. **Repudiation** :
   - Risk : Denial of actions or events leading to disputes
   - Mitigation : Implement robust logging and auditing mechanisms
   - Priority : Low
     - Probability : 0.2 (Low)
     - Monetary Value : 0.3 (Low)
     - Expected Value (EV) : 0.2 * 0.3 = 0.06 (Low)
   
6. **Elevation of Privilege** :
   - Risk : Unauthorized escalation of privileges
   - Mitigation : Regularly apply security patches and limit privileges
   - Priority : Low
     - Probability : 0.2 (Low)
     - Monetary Value : 0.3 (Low)
     - Expected Value (EV) : 0.2 * 0.3 = 0.06 (Low)

Prioritizing these risks, "Poor People on the Road" can focus on addressing the most critical threats to its operations and customer data, while allocating resources effectively for risk mitigation.



The travel agency,  could potentially be targeted by specific threat actors, depending on several factors.

##### Capability, Opportunity, and Intent (COI) :

**1. Capability :**

   - Threat actors with the capability to target businesses may include cybercriminals or even competitors. These threat actors possess the technical skills and resources to carry out attacks.

**2. Opportunity :**

   - The opportunity for threat actors to target the travel agency depends on its online presence, the attractiveness of its assets (customer data, financial information), and the vulnerabilities in its systems. For example, if the agency has a publicly accessible website with security weaknesses, it may present an opportunity for attackers.

**3. Intent :**

   - Intent can vary widely among threat actors. Some may seek financial gain through data theft or ransomware attacks. Others may have ideological motives, such as hacktivists targeting travel agencies for perceived ethical reasons. Competitors might attempt corporate espionage.

##### **Known TTPs (Tactics, Techniques, Procedures) :**

- **Phishing** : Attackers send deceptive emails to employees or customers to trick them into revealing sensitive information.
- **Ransomware** : Encrypting critical data and demanding a ransom for decryption.
- **SQL Injection** : Exploiting vulnerabilities in web applications to gain unauthorized access to databases.
- **Brute Force Attacks** : Attempting to crack passwords to gain access to systems.
- **Insider Threats** : Malicious actions or data breaches carried out by employees or contractors with access to sensitive information.
- **DDoS Attacks** : Overwhelming systems with traffic to disrupt services.


While "Poor People on the Road" may not be a high-profile target like a financial institution or government agency, it is not immune to cyber threats. The travel industry is a valuable target due to the potential for financial gain and access to customer data. Therefore, the agency should implement robust cybersecurity measures. Threat actors may vary in capability, opportunity, and intent, but proactive security measures can help mitigate risks.

### What are we going to do about it ?

Strategies that can be applied using the framework of risk management, which includes actions to reduce, transfer, avoid, or accept risks :

**1. Reduce Attack Surface :**

   - **Network Segmentation** : Divide the internal network into segments to limit lateral movement for attackers.
   - **Least Privilege Principle** : Restrict user and system access to the minimum necessary for their roles.
   - **Regular Vulnerability Scanning **: Conduct routine scans to identify and address vulnerabilities in systems and software.
   - **Web Application Firewall (WAF) **: Deploy a WAF to filter and block malicious traffic targeting web applications.
   - **Security Awareness Training** : Train employees and contractors on security best practices to reduce the risk of human error.

**2. Limit Entry Points :**

   - **Implement Strong Authentication** : Enforce multi-factor authentication (MFA) for employees accessing critical systems.
   - **Secure Remote Access **: Ensure secure remote access mechanisms, such as VPNs, for employees working remotely.
   - **Network Security** : Employ firewalls and intrusion detection systems to filter incoming and outgoing traffic.

**3. Risk Transfer:**

   - **Insurance** : Consider purchasing cyber insurance to mitigate financial losses in case of a data breach or cyberattack.
   - **Outsourcing** : Consider third-party security service providers for tasks like penetration testing, threat intelligence, or security monitoring.

**4. Risk Avoidance :**

   - **Data Minimization** : Collect and retain only the data necessary for business operations, reducing the amount of sensitive information stored.
   - **Use of Third-Party Services **: Consider outsourcing payment processing to third-party providers that specialize in secure transactions to avoid handling sensitive financial data directly.

**5. Risk Acceptance :**

   - **Incident Response Plan **: Develop and maintain an incident response plan to mitigate and manage the impact of security incidents when they occur.
   - **Regular Risk Assessment** : Continuously assess and reevaluate the security posture to identify new risks and accept them when the cost of mitigation outweighs the potential impact.

### Did we do a good enough job ?

To determine if the company has done a good enough job it's essential to adopt a proactive approach to security assessment and evaluation. Here are key activities and practices to consider :

**1. Security Audits :**

   - Regularly conduct internal security audits and assessments to evaluate the effectiveness of security controls
   - Consider third-party audits by reputable security firms to provide an objective evaluation of security practices.

**2. Penetration Testing (PenTests) :**

   - Periodically engage in penetration testing to simulate real-world attacks and identify vulnerabilities.
   - Penetration tests should cover various attack vectors, including web applications, network infrastructure, and social engineering.

**3. Continuous Threat Modeling :**

   - Maintain a threat modeling process that evolves with the changing threat landscape and business operations.
   - Continuously update threat models to identify new risks and vulnerabilities.

**4. Security Assessments :**

   - Conduct regular security assessments, including vulnerability scanning and risk assessments, to identify and prioritize security weaknesses.
   - Use the results of assessments to guide security improvements.

**5. Evaluation of Security Controls :**

   - Continuously evaluate the effectiveness of security controls, such as firewalls, intrusion detection systems, and access controls.
   - Ensure that security controls are up-to-date and aligned with the evolving threat landscape.

**6. Incident Response Drills :**

   - Regularly perform incident response drills and tabletop exercises to test the effectiveness of the incident response plan.
   - Evaluate the ability to detect, respond to, and recover from security incidents.

**7. Compliance and Standards :**

   - Ensure compliance with relevant cybersecurity standards and regulations that apply to the travel industry.
   - Use compliance frameworks as a baseline for security measures.

**8. Security Awareness and Training :**

   - Continuously educate employees and contractors about the latest security threats and best practices.
   - Evaluate the success of security awareness programs through testing and monitoring.

**9. Feedback and Improvement :**

   - Establish a feedback loop for reporting and addressing security incidents, vulnerabilities, and near misses.
   - Regularly review security incident reports and take corrective actions to prevent recurrence.

**10. Third-Party Risk Management :**

- Assess the security posture of third-party vendors and service providers, especially those handling sensitive customer data.

- Ensure that third parties adhere to security standards and practices.

_______

# Sources

*Threat Modeling Manifesto*. https://www.threatmodelingmanifesto.org/

*World’s Shortest Threat Modeling Course - YouTube*. https://www.youtube.com/playlist?list=PLCVhBqLDKoOOZqKt74QI4pbDUnXSQo0nf

*Chapter 1: Dive In and Threat Model! - Threat Modeling: Designing for Security [Book]*. https://www.oreilly.com/library/view/threat-modeling-designing/9781118810057/9781118810057c01.xhtml

*Threat Modeling - OWASP Cheat Sheet Series*. https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html

« 4+1 Architectural View Model ». *Wikipedia*, https://en.wikipedia.org/w/index.php?title=4%2B1_architectural_view_model&oldid=1172627664

*Threat Modeling - OWASP Cheat Sheet Series*. https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html#manage-to-present-your-dfd-in-the-context-of-mvc

*Real World Threat Modeling Using the PASTA Methodology* https://owasp.org/www-pdf-archive/AppSecEU2012_PASTA.pdf

*ChatGPT - OpenAI* [ChatGPT (openai.com)](https://chat.openai.com/?model=text-davinci-002-render-sha)

*How to Use Data Flow Diagrams in Threat Modeling - Threat-Modeling.Com*. 6th october 2022, https://threat-modeling.com/data-flow-diagrams-in-threat-modeling/.
