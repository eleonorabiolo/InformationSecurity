## A05:2021 – Security Misconfiguration

### Overview

-  90% of applications were tested for some form of misconfiguration.

### Description

Here are some reasons why an application can be vulnerable:

- Unnecessary features are enabled or installed
- Default accounts and their passwords are still enabled and unchanged
- For upgraded systems, the latest security features are disabled or not configured securely

To ensure a well-protected system, having a repeatable application security configuration process is mandatory.

### How to Prevent

Here are some features that a secure installation process needs to have:

- A repeatable hardening process. This process should be automated to minimize the effort required to set up a new secure environment
- A minimal platform. It's necessary to remove or not install unused features and frameworks
- A task to review and update the configurations in line with all security notes, updates, and patches as part of the patch management process
- An automated process that allows verification of the effectiveness of configurations and settings in all environments

### Example Attack Scenarios

- A cloud service provider (CSP) has default sharing permissions open to the Internet by other CSP users. This allows sensitive data stored within cloud storage to be accessed

_____

## A06:2021 – Vulnerable and Outdated Components

### Overview

Vulnerable Components are a known issue that we struggle to test and assess risk 

### Description

When are you vulnerable?

- If you do not know the versions of all components you use
- If the software is vulnerable, unsupported, or out of date
- If you do not know the versions of all components you use
- If you do not fix or upgrade the underlying platform, frameworks, and dependencies in a risk-based, timely fashion
- If you do not fix or upgrade the underlying platform, frameworks, and dependencies in a risk-based, timely fashion
- If you do not secure the components’ configurations

### How to Prevent

- Remove unused dependencies, unnecessary features, components, files, and documentation
- Continuously inventory the versions of both client-side and server-side components and their dependencies 
- Only obtain components from official sources over secure links
- Monitor for libraries and components that are unmaintained or do not create security patches for older versions

Every organization must ensure a plan for monitoring, triaging, and updating or modifying application configurations throughout their entire lifespan.

### Example Attack Scenarios

Such flaws can be accidental or intentional. Here some component vulnerabilities :

- CVE-2017-5638 : remote code execution vulnerability that enable the execution of code on the server

While the IoT is frequently difficult or impossible to patch, the importance of patching them can be great. There are automated tools to help attackers find unpatched or mis configured systems. 

___

## A03:2021 – Injection

### Overview

94% of the applications were tested for some form of injection with a max incidence rate of 19%, an average incidence rate of 3%

### Description

When is an application vulnerable to attack?

- User-supplied data is not validated or filtered by the application
- Hostile data is used within object-relational mapping (ORM) search parameters to extract additional, sensitive records
- Hostile data is directly used or concatenated. The SQL or command contains the structure and malicious data in dynamic queries, commands, or stored procedures

 Source code review is the best method of detecting if applications are vulnerable to injections. Automated testing of all parameters, headers, URL, cookies, JSON, SOAP, and XML data inputs is strongly encouraged.

Automated testing of all parameters, headers, URL, cookies, JSON, SOAP, and XML data inputs is strongly encouraged.

### How to Prevent

To prevent injection is necessary to keeping data separate from commands. The preferred option is to use a safe API, which avoids using the interpreter entirely, provides a parameterized interface, or migrates to Object Relational Mapping Tools.

Use LIMIT and other SQL controls within queries to prevent mass disclosure of records in case of SQL injection.

### Example Attack Scenarios

- An application uses untrusted data in the construction of the following vulnerable SQL call:

  ```sql
  String query = "SELECT \* FROM accounts WHERE custID='" + request.getParameter("id") + "'";
  ```

- An application’s blind trust in frameworks may result in queries that are still vulnerable

  ```sql
   Query HQLQuery = session.createQuery("FROM accounts WHERE custID='" + request.getParameter("id") + "'");
  ```

In both cases, the attacker modifies the ‘id’ parameter value in their browser to send: ' UNION SLEEP(10);--. For example:

```
 http://example.com/app/accountView?id=' UNION SELECT SLEEP(10);--
```

This changes the meaning of both queries to return all the records from the accounts table

______

## Install WebGoat

```
1. Open your virtual machine
2. Open the command prompt 
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/bda38d88-f48b-4b7f-baf1-81077c49698a)

```
3. Install Java by typing that into your command prompt
```

```
#This command updates the list of available packages
$ sudo apt-get update
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/315f85d8-293f-4b7c-9f9e-a02afe4dbbe8)


```
#This command installs the OpenJDK 17 Runtime Environment (openjdk-17-jre), the Uncomplicated Firewall (ufw), the wget utility, and the Bash completion package (bash-completion). The -y flag automatically confirms any prompts that might come up during the installation process.
$ sudo apt-get -y install openjdk-17-jre ufw wget bash-completion
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/94816790-74ac-49f9-b336-73bfd1d1d810)


```
Here type "y"
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/46556d81-6f3b-455e-b9a8-bdf792a27329)


```
4. Enable firewall
   $ sudo ufw enable
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/6a71fa1d-d3d7-4627-9502-f439f6deb030)


```
5. Dowload webgoat 8
$ wget https://terokarvinen.com/2020/install-webgoat-web-pentest-practice-target/webgoat-server-8.0.0.M26.jar
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/9127c189-316f-4d4c-a934-846ce0daea7a)


```
6. Run webgoat 8
$ java -jar webgoat-server-8.0.0.M26.jar
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/25aae029-1504-434f-b22a-7b7c659d93e1)


```
7. Open the web browser
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/58f7b565-201e-4076-8146-ef6ccba59180)


```
8. Search fot this link : http://localhost:8080/WebGoat/  
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/fa62991d-712b-44b2-802d-43e44e9f9622)


```
9. It's time to register a new user in WebGoat
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/e7592080-f328-44a9-af89-8191891853d9)


```
10. Enter your information and sign up - The browser will ask you if you want it to save the password for the next time. I recommend saying no for your security
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/08b8ffad-ab05-4d72-8b1e-4fe7f9152e60)


Good job, web goat is installed ! :tada:

_____

##  F12. Solve Webgoat 8: General: Developer tools



```
Click on General then on Developer tools
```
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/06712b64-84ac-4159-b813-24f4daf31bdb)

**Solve the step of this category** 
```
1. Click on F12 to open the inspection
```
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/f9288b5d-045b-4c39-b65f-22e3cefea0d5)

```
2. Read point 2
```
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/aa9bafad-3b05-4456-80c7-bad89d5db7cb)

```
3. Read point 3 and do the task
- Select "Console" in the inspection case and write the different instruction
	- console.log("Hello WebGoat !"); then press enter to see the result
	- 1+3  then press enter to see the result
```
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/d2e05a03-f550-42ca-83be-d9ede499d003)

```
4. Read point 4 and do the task
- Write the instruction
	- webgoat.customjs.phoneHome()
- Copy paste the number into the field (don't forget the minus before the number)
```
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/bd37f6c1-7ed0-401f-ae0d-c93a03ce7b10)

```
5. Read point 5 and do the task
- Find the file in "Source" part
- Then take a look at the "Network"
```
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/edb589d3-2f23-4cba-ab1b-dbbad1517f99)
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/2ef3fdcd-b754-4c3a-9858-7c7489ab2689)

```
6. Read point 6 and do the task
- Click on "Go"
- Scroll until the end and choose the File "Network"
- Click on request, here you can find your number
```
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/3ae29eaf-1fa9-4548-aaf3-09afc47597bb)

```
Copy the number and paste it on the field, then click on "check"
```
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/34a77c10-2d7a-4500-992e-2123ce5bd2f9)




____

## Not outdated. Update all operating system and all applications in your Linux.

Follow the steps 

**Operating system**

```
1. Update Package Repositories - This ensures that your system knows about the latest available packages
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/21aef762-5384-4eaf-8196-c12b44e06fd7)


```
2. Upgrade Packages - Upgrade your installed packages to their latest versions
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/28bee607-1252-4638-a5e6-8cf739a44bd8)


![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/9acb1693-9859-410e-856e-dd351b66f3e9)


**Applications**

```
3. Update the web borwser
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/e36ef302-57a2-4e8b-b45a-6c6b820f22c3)


```
4. Update the file manager
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/3e78fc0e-0ca1-42da-8019-365afd6a3053)


```
5. Update the mail reader
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/3c1a4a0e-5736-4b24-ba70-dcf087b361b7)

________

## Sequel. Solve SQLZoo

### 0 SELECT basics - SELECT basics

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/b9d36d9a-e903-4d64-980a-5ada9fca42ea)


#### Introducing the `world` table of countries

*Previous SQL request :* 

`SELECT name, population FROM world`
		`WHERE name = 'France'`

Correct answer : `SELECT population FROM world WHERE name = 'Germany'`

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/f6aa24fc-d3eb-466f-9e29-84b1a7e32497)


```
I replaced the country and used "Germany" instead of "France"
```





#### Scandinavia

*Previous SQL request :* 

`SELECT name, population FROM world`
		`WHERE name IN ('Brazil', 'Russia', 'India', 'China');`

Correct answer : `SELECT name, population FROM world WHERE name IN ('Sweden', 'Norway', 'Denmark');`

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/6a06abb5-26d6-4e7e-a015-457b11b8143a)






#### Just the right size

*Previous SQL request :*

`SELECT name, area FROM world`
		`WHERE area BETWEEN 250000 AND 300000`

Correct answer : `SELECT name, area FROM world WHERE area BETWEEN 200000 AND 250000`

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/9a11a044-c9ce-4e1c-b432-678996fe51b9)






### 2 SELECT from World, from first two subtasks - SELECT from WORLD Tutorial

#### Introduction

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/88ae21e7-2ed3-4603-b5c3-1c83ce56c2be)


```
Using this SQL query, I can view the name, continent, and population of all countries in the "world" table.
```





#### Large Countries

*Previous SQL request :*

`SELECT name FROM world`
		`WHERE population = 64105700`

Correct answer : `SELECT name FROM world WHERE population >= 200000000`

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/90c737f4-38f1-4f1b-b74b-0292363e4439)


_____

## Johnny tables. Solve Portswigger Labs

Open the lab and click on "Gift"

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/99353378-5f85-402a-8ae4-32e1efae5770)


This is the basic link :

```
https://0a7700560305f8bd80f4447c0074000c.web-security-academy.net/filter?category=Gifts
```

Here the products that we can see

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/2f5b603d-9494-417a-a523-8e72989e0484)


Now, we want to view one or more unreleased products. To do so, replace "gifts" with "'+OR+1=1--"

The new link will look like that :

```
https://0a7700560305f8bd80f4447c0074000c.web-security-academy.net/filter?category=%27+OR+1=1--
```

Now, we can see more products 

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/3f133ccd-33fc-453a-b019-27f488a7cee1)


Congratulations, you've successfully solved the lab ! :smile:

## Sources

*A05 Security Misconfiguration - OWASP Top 10:2021*. https://owasp.org/Top10/A05_2021-Security_Misconfiguration/

*A06 Vulnerable and Outdated Components - OWASP Top 10:2021*. https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/

*A03 Injection - OWASP Top 10:2021*. https://owasp.org/Top10/A03_2021-Injection/

*Install Webgoat 8 - Learn Web Pentesting*. https://terokarvinen.com/2020/install-webgoat-web-pentest-practice-target/

*ChatGPT - OpenAI* [ChatGPT (openai.com)](https://chat.openai.com/?model=text-davinci-002-render-sha)

*SQLZOO*. https://sqlzoo.net/wiki/SQL_Tutorial

*SELECT basics - SQLZOO*. https://sqlzoo.net/wiki/SELECT_basics

*SELECT from WORLD Tutorial - SQLZOO*. https://sqlzoo.net/wiki/SELECT_from_WORLD_Tutorial

*Read the notes about this table. - SQLZOO*. https://sqlzoo.net/wiki/Read_the_notes_about_this_table

*WHERE filters - SQLZOO*. https://sqlzoo.net/wiki/WHERE_filters

*Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data | Web Security Academy*. https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data

