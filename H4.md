# Schneier 2015: Applied Cryptography

## Foundation

### 1.1 Terminology 

#### Sender and receiver

- Sender wants to send a message to someone.
- Sender wants to keep the message safe from spies.
- Spies are people who might try to read the message without permission.

#### *Messages and Encryption*

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/d2fd4c96-ef51-4954-8a11-aa424693c728)


- Message = plaintext, what you want to send.
- Encryption disguises the message to make it secure.
- Encrypted message = ciphertext.
- Decryption turns ciphertext back into plaintext.

- Cryptography and Cryptanalysts:
  - Cryptography = keeping messages secure.
  - Cryptographers practice cryptography.
  - Cryptanalysis = breaking encrypted messages.
  - Cryptanalysts practice cryptanalysis.
  - Cryptology = math behind cryptography and cryptanalysis.
  - Cryptologists are experts in cryptology, often good at math.
- Plaintext and Ciphertext:
  - Plaintext = the message (M or P).
  - It can be anything digital.
  - Computer sees it as binary data.
  - Plaintext can be for sending or storing.
  - Ciphertext = encrypted message (C).
  - C can be the same size or larger than M.

#### *Algorithms and Keys*

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/280f9547-4e6f-4489-aaf7-018bd15f418c)
 Encryption and decryption with a key

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/7d497581-a756-4b9f-b8cf-5bc5872c82c3)
With two different keys

- Cryptographic Algorithm (Cipher):
  
  - It's a math function for encryption and decryption.
  - Uses two functions: one for encrypting and one for decrypting.
  
- Restricted Algorithms:
  - Rely on keeping the algorithm secret.
  - Inflexible â€“ users must change when someone leaves or if the secret leaks.
  - No standardization; each group needs a unique algorithm.
  
- Modern Cryptography with Keys:
  - Uses a key (K) for security.
  - Key can have many possible values (keyspace).
  - Encryption and decryption rely on this key.

  - Some algorithms use separate keys for encryption (K1) and decryption (K2).
  
- Security Based on the Key, Not Algorithm:
  - Algorithm details can be made public and analyzed.
  - Security depends on the secrecy of the key, not the algorithm itself.
  
- Cryptosystem:
  - It's the whole package - algorithm, possible plaintexts, ciphertexts, and keys.

#### Symmetric Algorithms

- Two Types of Key-Based Algorithms:
  - Symmetric and public-key.
- Symmetric Algorithms (Secret-Key Algorithms):
  - Encryption key can be derived from the decryption key, and vice versa.
  - Often, encryption and decryption use the same key.
  - Require sender and receiver to agree on a key for secure communication.
  - Security depends entirely on keeping the key secret.
  - Key secrecy is crucial as long as communication needs to stay secure.
- Categories of Symmetric Algorithms:
  - Stream Algorithms (Stream Ciphers): Process plaintext bit by bit (or byte by byte).
  - Block Algorithms (Block Ciphers): Process plaintext in groups of bits (blocks).

#### *Public-Key Algorithms*

- Public-Key Algorithms (Asymmetric Algorithms):
  - Encryption and decryption use different keys.
  - Decryption key can't be easily calculated from the encryption key.
  - Encryption key can be made public.
  - A stranger can use the encryption key to encrypt a message.
  - Only the specific person with the decryption key can decrypt it.
- Public and Private Keys:
  - Encryption key = public key.
  - Decryption key = private key (secret key)
- Digital Signatures:
  - Messages can be encrypted with the private key and decrypted with the public key.
  - Used in digital signatures for security and authentication.

#### *Cryptanalysis*

- Cryptography's Goal:
  - Keep plaintext, key, or both secret from attackers.
  - Attackers have complete access to the communication.

- Cryptanalysis:
  - The science of uncovering plaintext without knowing the key.
  - Successful cryptanalysis can reveal plaintext or keys.
  
- There are several types of Cryptanalytic Attacks like:
  - Ciphertext-Only Attack: Attacker has only ciphertext, aims to recover plaintext or key.
  - Known-Plaintext Attack: Attacker has both plaintext and ciphertext, tries to deduce the key.
  - Chosen-Plaintext Attack: Attacker chooses plaintext to encrypt, trying to deduce the key.
  - And more, ...
  
- Importance of Public Algorithms:
  - Cryptographic algorithms should be made public for security.
  - Security shouldn't rely on keeping the algorithm secret.
  
- Real-World Cryptanalysis:
  - Known-plaintext and chosen-plaintext attacks happen.
  - Some messages have predictable content.
  - Algorithms in commercial software can be reverse-engineered.
  
  - Algorithms that aren't public are often questionable.

#### *Security of Algorithms*

- Algorithm Security Depends on Difficulty to Break:
  - If breaking an algorithm costs more than the value of the data, or takes longer than data needs to stay secret, it's likely safe.
  - Also, if the data encrypted with one key is less than what's needed to break the algorithm, it's probably secure.

  - Data value should always be less than the cost to break the security.
  
- Unconditional Security and Brute-Force Attack:
  - Only a one-time pad is unbreakable with infinite resources.
  - All other systems can be broken in a ciphertext-only attack using brute force (trying every key).

- Computational Security:
  - Focus on cryptosystems that are computationally infeasible to break.
  - Computational security means it can't be broken with available resources (current or future).

- Measuring Attack Complexity:
  - Complexity measured in terms of data needed, processing time, and storage.
  - Often, the lowest of these is considered the overall complexity.
  
- Expressing Complexity:
  - Complexity expressed as orders of magnitude.
  - Even with immense computing power, some tasks can take billions of times the age of the universe.
  
- Computing Power Advances:
  - Computing power has grown significantly.
  - Good cryptosystems are designed to remain secure against future computing power advances.

#### *Historical Terms*

- Codes vs. Ciphers:
  - Historically, a "code" in cryptography deals with linguistic units like words, phrases, or sentences.
  - For example, a code might replace "TURN LEFT 90 DEGREES" with the word "OCELOT."
  - Codes are specialized and limited to specific situations.
  - Ciphers, on the other hand, are versatile and can be used in any circumstance.
  - With a code, if there's no code word for a particular message, you can't communicate it.
  - Ciphers allow you to encode any message, offering more flexibility.

### 1.2 Steganography 

- Steganography Purpose:
  - To hide secret messages within other messages, making the existence of the secret message hidden.
- Modern Techniques:
  - Hiding messages in graphic images.
  - Replace the least significant bit of each byte in an image with bits of the secret message, the human eye typically won't notice the change, and the message can be extracted later.
  - Can hide a substantial message within an image without altering its appearance much.
  - Several public-domain programs are available for this purpose.
- Obfuscating Messages:
  - This kind of steganography aims to confuse automated systems scanning for interesting content but may not fool humans.

### 1.3 Substitution ciphers and transposition ciphers

- Modern Cryptography:
  - Today, cryptography works with bits instead of characters.
  - This is like changing the alphabet size from 26 letters to just two (0 and 1).
  - Most good cryptographic algorithms still involve both substitution and transposition techniques.
  

The core idea of cryptography remains the same: hiding information through various methods, but the tools have evolved with technology.

#### *Substitution Ciphers*

- Substitution Ciphers:
  - Substitution ciphers replace characters in plaintext with characters in ciphertext.
  - The receiver reverses this process to obtain the original plaintext.
- Types of Substitution Ciphers:
  - Simple Substitution Cipher (Monoalphabetic Cipher):
    - Each plaintext character is replaced by a corresponding ciphertext character.
    - Often used in newspapers' cryptograms.
  - Homophonic Substitution Cipher:
    - Similar to simple substitution but allows one plaintext character to map to multiple ciphertext characters.
    - Provides more complexity but doesn't fully obscure statistical properties of the language.
  - Polygram Substitution Cipher:
    - Encrypts blocks of characters together.
  - Polyalphabetic Substitution Cipher:
    - Multiple simple substitution ciphers used together.
    - Different keys for each letter of the plaintext.
    - Periodicity (key recycling) is a characteristic of these ciphers.
  - Running-Key Cipher (Book Cipher):
    - One text is used to encrypt another.
- Example Ciphers:
  - Caesar Cipher: Each character shifted three positions down the alphabet.
  - ROT13: A simple encryption technique where each character is rotated 13 places. ROT13 applied twice restores the original text.

Cryptography has evolved significantly, and modern encryption techniques are far more secure than these historical substitution ciphers.

#### *Transposition Ciphers*

- Transposition Cipher:
  - In a transposition cipher, the plaintext remains the same, but the order of characters is rearranged.
  - In a simple columnar transposition cipher, the plaintext is written horizontally with a fixed width, and the ciphertext is read vertically.
  - Decryption involves writing the ciphertext vertically with the same width and reading the plaintext horizontally.

- Cryptanalysis of Transposition Ciphers:
  - Frequency analysis on the ciphertext reveals that each letter has a similar likelihood as in English.
  - Cryptanalysts can use this information to determine the correct ordering of letters and obtain the plaintext.
  - Applying a second transposition cipher can enhance security, but most transposition ciphers can be broken by computers.

- Modern Cryptography:
  - Many modern algorithms use transposition, but it can be memory-intensive and may require specific message lengths.
  - Substitution is more common in modern cryptography due to its practicality.


Transposition ciphers, although historically significant, are generally less secure and less commonly used in modern cryptography compared to substitution ciphers.

#### *Rotor Machines*

- Rotor Machines in the 1920s:
  - Mechanical encryption devices were invented in the 1920s to automate encryption.
  - These devices used rotors, which were mechanical wheels with wired substitutions.
  - Rotors had 26 positions, each representing a simple substitution of the alphabet.
  - Multiple rotors and their movement made the machine secure, with a period of 26^n for an n-rotor machine.
- Enigma Machine:
  - The Enigma machine is a well-known rotor device.
  - Used by the Germans during World War II.
  - Invented by Arthur Scherbius and Arvid Gerhard Damm in Europe, patented by Scherbius in the United States.
  - Despite its complexity, the Enigma was broken during World War II.
- Cryptanalysis of Rotor Ciphers:
  - Polish cryptographers first broke the German Enigma and shared their findings with the British.
  - The Germans modified their Enigma, and the British continued to decrypt newer versions.

Rotor machines, particularly the Enigma, played a significant role in the history of cryptography, both as encryption tools and as subjects of cryptanalysis during World War II.

### 1.4 Simple XOR

The XOR operation (exclusive-or) is a standard bitwise operation where the result is 1 if the bits being compared are different and 0 if they are the same. For example:
- 0 XOR 0 = 0
- 0 XOR 1 = 1
- 1 XOR 0 = 1
- 1 XOR 1 = 0

Additionally:
- A XOR A = 0
- A XOR B XOR B = A

The simple XOR algorithm is often used in commercial software packages, especially in MS-DOS and Macintosh environments. However, it lacks strong security and is not suitable for protecting sensitive information. It is a symmetric algorithm, meaning the same process is used for both encryption and decryption.

Despite its prevalence in some software, XOR encryption is not secure and can be easily broken, even without the use of computers. It is not suitable for protecting sensitive data and should not be relied upon for robust encryption.

### 1.5 One-time pads

The one-time pad, also known as the Vernam cipher, is indeed a perfect encryption scheme when used correctly. It was invented in 1917 and offers absolute security under certain conditions. Here's how it works:

1. A one-time pad consists of a large set of truly random key letters or bits. These key letters are generated randomly and have to be truly random, not generated by a pseudo-random number generator.

2. Each key letter is used to encrypt exactly one character or bit of the plaintext. The encryption is typically done using modulo addition for characters or bitwise XOR for binary data.

3. After each key letter is used once, it is destroyed or never used again. This means the key sequence should never repeat.

The security of the one-time pad relies on two critical factors:
- The key letters are truly random.
- Each key letter is used only once.

Under these conditions, the one-time pad provides perfect security because it produces ciphertext that is essentially random. Since every possible plaintext message of the same length is equally likely, there is no way for a cryptanalyst to determine the correct plaintext message. The security is unconditional, and no amount of computing power can break it.

However, there are practical limitations and challenges with the one-time pad:
1. Key Distribution: The key must be securely distributed to both the sender and receiver in advance. This can be challenging, especially for long keys.

2. Key Storage and Management: The keys must be kept secret and secure. Once a key is used, it should be destroyed, and new keys should be generated.

3. Key Length: The key length must be equal to or greater than the length of the message. This makes it impractical for encrypting large volumes of data, especially for high-speed communications.

4. Synchronization: The sender and receiver must be perfectly synchronized. Any misalignment can result in decryption errors.

5. Lack of Authentication: The one-time pad provides encryption but does not offer authentication. An attacker could alter the ciphertext without detection.

Despite these challenges, the one-time pad has practical applications in scenarios where absolute security is required for short messages. It has been used historically for secure communication, and messages encrypted with a one-time pad remain secure indefinitely, provided the key remains secret.

### 1.6 Computer algorithms

1. **DES (Data Encryption Standard):**
   - Symmetric-key encryption algorithm.
   - Developed in the 1970s, widely used but no longer considered secure.
   - Operates with a shared secret key, using a fixed block size of 64 bits.

2. **RSA (Rivest, Shamir, and Adleman):**
   - Asymmetric or public-key encryption and digital signature algorithm.
   - Invented in 1977, still secure with sufficiently long key lengths.
   - Utilizes a pair of keys, public and private, for encryption and decryption.

3. **DSA (Digital Signature Algorithm):**
   - Public-key digital signature algorithm.
   - Used for generating and verifying digital signatures, not for encryption.
   - Relies on modular arithmetic and the discrete logarithm problem for security.

These algorithms are fundamental in the field of cryptography, each serving specific encryption and authentication purposes. Always consider current best practices and security standards when selecting cryptographic algorithms and key lengths.

### 1.7 Large numbers

This table contains large numbers to help you understand the scale of things in cryptography. Think of these numbers like comparisons to everyday events:

| Physical Analogue                                            | Number               |
| ------------------------------------------------------------ | -------------------- |
| Odds of being killed by lightning (per day)                  | 1 in 9 billion (233) |
| Odds of winning the top prize in a U.S. state lottery        | 1 in 4,000,000 (222) |
| Odds of winning the top prize in a U.S. state lottery and being killed by lightning in the same day | 1 in 255             |
| Odds of drowning (in the U.S. per year)                      | 1 in 59,000 (216)    |
| Odds of being killed in an automobile accident (in the U.S. in 1993) | 1 in 6100 (213)      |
| Odds of being killed in an automobile accident (in the U.S. per lifetime) | 1 in 88 (27)         |
| Time until the next ice age                                  | 14,000 (214) years   |

And more, ...

____





# What are the six most common letters (in italian) ?

The frequency distribution of letters in the **Italian** language is approximately as follows : 

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/65eb79ed-1144-49fe-acda-dbb91dbd73b7)


The frequency table of italian letter is : **EAIONT**. So similar in english (ETAOIN).

_______





# Choose a password manager

I chose "pass".

- **What threats does it protect against?**

  This password manager, like others, protects our passwords against unauthorized access. In fact, even if someone manages to gain access to the password manager, the passwords are encrypted, so the password data remains secure. To see them, you would need the decryption key.

- **What information is encrypted, what's not?**

  In "pass," all the passwords and usernames are encrypted. However, the folder structure and filenames are not encrypted, so if someone gains access, they can see them (but not the passwords).

- **What's the license? How would you describe license's effects or categorize it?**

  "Pass" uses the GNU (GPL) license. This means it's open-source software, which allows anyone to use it and make changes to it freely. If someone makes changes, they have to share those changes with others under the same GPL license. This way, it encourages people to work together and share their code improvements.

- **Where is the data stored? If in "the cloud", which country / jurisdiction / which companies? If on local disk, where?**

  "Pass" keeps your password data on your computer in a special folder. The exact spot can vary depending on your computer's operating system, but usually, it's in a folder named "password-store" inside your personal area. This is like having a safe at home for your passwords, and you're in charge of it.

  However, "pass" also lets you decide if you want to copy your passwords to the internet, like the cloud or other computers far away. But it won't do this on its own; you have chose this option.

- **How is the data protected?**

  "Pass" keeps your passwords safe by transforming them into secret codes. It does this with the GPG encryption tool. These secret codes are like puzzles only your special GPG key can solve. Your private key is like a secret key that unlocks these puzzles. So, even if someone breaks into your password manager, they won't see your actual passwords because they don't have the secret key to solve the puzzles.

______





# ETAOIN

When asked to come up with encryption scheme in the class, almost everyone described a variation of a simple substitution chipher. As requested, now it's time to attack your own scheme! Crack this ciphertext:

```
HDMH'B TH. KWU'YI AWR WSSTOTMJJK M OWQINYIMLIY! MB KWU BII, BTGPJI BUNBHTHUHTWA OTPDIYB OMA NI NYWLIA RTHD SYIEUIAOK MAMJKBTB. BII KWU MH DHHP://HIYWLMYCTAIA.OWG
```

```
That's it you're now officially a codebreaker as your see ! Simple substitution ciphers can be broken with frequency analysis. See you at http://terokarvinen.com
```

![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/fdb80b59-e381-4f75-8fe6-aa6a8edefff5)


![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/90425f1b-5670-49bf-9883-a7798fb9505c)


_______________







# Demonstrate the use of a password manager

1. ```
   Install the password manager (pass)
   ```

   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/8cb1e484-00bf-45ce-8d1d-fb6e29e4b06b)


2. ```
   Initialize pass
   It creates a new folder called ".password-store" related to my email
   ```

   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/2f611c65-3fd3-4a46-a03e-d4bdc9d1f7ad)


3. ```
   Add a passowrd (you need to already have a gpg key)
   ```

   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/4dd39e41-154f-4bf8-9de0-4d74cb50a1ea)


4. ```
   Retrieve a password - this is an example; the password you will see is not a real one. Feel free to try it :)
   ```

   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/56781b9c-7e4c-4921-aa12-beebb07c7251)


   5. ```
      You can also generate random passwords
      ```

      ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/602079d7-ec46-4c82-9007-a03e722e1fb3)


   6. ```
      To see the list of your stored passwords
      ```

      ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/5bc3bca6-4830-41be-93c3-bfe292ac2370)


   7. ```
      Edit a password
      ```

      ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/86eb0b25-41f7-46a8-8dd1-39a6a9e1994f)


      Before :

      ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/bcb22606-c483-4586-8f3d-39a51b162920)


      After :

      ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/ba9216f0-f6fe-4546-a36a-360cdb9630e3)


      ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/a8386d31-98e7-4050-943b-e5456efdec5b)


   8. ```
      Remove a passowrd
      ```

      ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/bc6fd4b2-fd11-4e9c-80ca-aec6760203ca)


      As you can see the password has been removed

      ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/006df6c6-bc53-4fbf-8534-e8e8d16d5eef)


__________





# Encrypt and decrypt a message and voluntary bonus

I chose the GPG tool because I already have some knowledge of how to use it. I will create two GPG keys because I will send myself an encrypted message to demonstrate how it works.

1. ```
   Open two different terminals
   ```

2. ```
   Create a public and private key pair for both users :
   user a. = eleonorabiolo@gmail.com
   user b. = bhg708@myy.haaga-helia.fi
   ```

   a. ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/a8b2e163-371c-467a-b54f-7ba11acdcc49)


   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/ba2a100d-d8d3-4e49-a8f2-a8303d7dfe45)


   b. ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/9e0d9dcd-ff59-4a96-ab19-5bbb4d37b224)


   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/0f24fbf7-d36d-466e-aeea-540dc1a9f82b)


3. ```
   Export the public key to a file
   ```

   a. ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/d36fccc5-a06c-444b-b936-8bcef53ef353)


   b. ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/0bfb70a6-3422-4a6a-b337-4d470f515e45)


4. ```
   Now user a. (eleonorabiolo@gmail.com) sends his public key to user b. (bhg708@myy.haaga-helia.fi)
   ```

   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/56fdffe4-8c9a-4450-ba6e-06d3b02c6669)


5. ```
   User b. imports the file and verifies the key
   ```

   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/ede6aa29-71d4-43c5-8865-bb1e352bccf6)


   The file will be downloaded in the "Downloads" folder, so I will move it to my home folder

6. ```
   Now, you have to import it
   ```

   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/eb97281c-3e96-47a6-b552-b8b3324f4b1f)


   Then press Ctrl+D

7. ```
   Verify the fingerprint
   "a" must be equal to "b".
   ```

   a. ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/0768a454-9543-4496-9a0e-87b819987cc7)
   
![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/49cf9dab-4d30-40c7-bcf9-4ccf50b63d29)


   b. ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/f42ee3cf-d53c-4b1d-8759-967e0ed4ccb8)


   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/e8b35f71-095b-4c93-b472-35bd8bf366de)


9. ```
   User b. sends a secret message to user a.
   ```

   ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/05a052a1-1cd9-433a-9f41-12b7f713cb70)


10. ```
   Send the secret message by email
   ```

11. ```
    User a. decrypts and reads the message
    ```

    ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/acb5a43c-b1e1-4094-adef-d8a982503450)


    ![image](https://github.com/eleonorabiolo/InformationSecurity/assets/71267403/5279e3c7-9b88-4053-a2c6-6b6b8828f6c6)


___________





# Sources

*CHAPTER 1: Foundations - Applied Cryptography: Protocols, Algorithms and Source Code in C, 20th Anniversary Edition [Book]*. https://www.oreilly.com/library/view/applied-cryptography-protocols/9781119096726/08_chap01.html

*ChatGPT - OpenAI* [ChatGPT (openai.com)](https://chat.openai.com/?model=text-davinci-002-render-sha)

Trost, Stefan. *Alphabet and Character Frequency: Italian (Italiano)*. https://www.sttmedia.com/characterfrequency-italian#letters

*Pass: The Standard Unix Password Manager*. https://www.passwordstore.org/

*Password-store - Simple password manager using gpg and ordinary unix directories.* https://git.zx2c4.com/password-store/about/
